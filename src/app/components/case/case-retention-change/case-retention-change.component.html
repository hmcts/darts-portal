<h1 class="govuk-heading-l">Change case retention date</h1>
<!-- Validation Error Summary Component -->
<app-validation-error-summary [errors]="errors"></app-validation-error-summary>
<div class="govuk-form-group">
  <fieldset class="govuk-fieldset">
    <legend class="govuk-fieldset__legend govuk-fieldset__legend--m">
      <h1 class="govuk-fieldset__heading">Select a new retention date</h1>
    </legend>
    <!-- Error message if date invalid -->
    <div *ngIf="isOptionInvalid()" id="retention-option-errors">
      <p class="govuk-error-message"><span class="govuk-visually-hidden">Error: </span>{{ errorNoOption }}</p>
    </div>
    <div
      id="change-radios"
      class="govuk-radios govuk-details"
      data-module="govuk-radios"
      [class.govuk-form-group--error]="isOptionInvalid()"
    >
      <div class="govuk-radios__item">
        <input
          class="govuk-radios__input"
          id="retention-option-date"
          name="retentionOptions"
          type="radio"
          [formControl]="retainOptionFormControl"
          (click)="onChangeOption()"
          value="date"
        />
        <label class="govuk-label govuk-radios__label" for="retention-option-date">Retain until a specific date</label>
      </div>
      <div
        *ngIf="retainOptionFormControl.value === 'date'"
        class="govuk-form-group"
        [class.govuk-details__text]="!isDateInvalid()"
        [class.govuk-form-group--error]="isDateInvalid()"
        id="change-date"
        (change)="onChangeDate()"
      >
        <div data-module="ds-datepicker" class="ds_datepicker">
          <label class="ds_label" for="retention-date">Enter a date to retain the case until</label>
          <p class="ds_hint-text">Use dd/mm/yyyy format. For example, 31/01/2023.</p>
          <!-- Error message if date invalid -->
          <div *ngIf="isDateInvalid()" id="retention-date-errors">
            <p class="govuk-error-message"><span class="govuk-visually-hidden">Error: </span>{{ errorDate }}</p>
          </div>
          <div class="ds_input__wrapper">
            <input
              aria-label="Enter a date in dd/mm/yyyy format"
              [formControl]="retainDateFormControl"
              name="retention-date"
              id="retention-date"
              type="text"
              class="ds_input ds_input--fixed-10"
              (change)="setDateValue($any($event).target.value)"
              [class.govuk-input--error]="isDateInvalid()"
            />
          </div>
        </div>
      </div>
      <div class="govuk-radios__item">
        <input
          class="govuk-radios__input"
          id="retention-option-permanent"
          name="retentionOptions"
          type="radio"
          [formControl]="retainOptionFormControl"
          (click)="onChangeOption()"
          value="permanent"
        />
        <label class="govuk-label govuk-radios__label" for="retention-option-permanent"
          >Retain permanently (99 years)</label
        >
      </div>
    </div>
    <div class="govuk-form-group reason-box" [class.govuk-form-group--error]="isReasonInvalid()">
      <label class="govuk-label govuk-!-font-weight-bold" for="change-reason">Why are you making this change?</label>
      <!-- Error message if reason invalid -->
      <div *ngIf="isReasonInvalid()" id="change-reason-errors">
        <p class="govuk-error-message"><span class="govuk-visually-hidden">Error: </span>{{ errorNoReason }}</p>
      </div>
      <app-govuk-textarea
        id="change-reason"
        name="reason"
        ariaDescribedBy="change-reason-hint"
        [control]="retainReasonFormControl"
        [maxCharacterLimit]="rententionCharacterLimit"
        [isInvalid]="isReasonInvalid()"
      ></app-govuk-textarea>
    </div>
    <div class="govuk-button-group">
      <button class="govuk-button" id="continue-button" data-module="govuk-button" (click)="onConfirm()">
        Continue
      </button>
      <a href="#" (click)="onCancel($event)" class="govuk-link">Cancel</a>
    </div>
  </fieldset>
</div>
