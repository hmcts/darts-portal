@if (transcript$ | async; as vm) {
  <ng-template #caseDetailsTable>
    <table class="govuk-table">
      <caption class="govuk-table__caption govuk-table__caption--m">
        Case details
      </caption>
      <tbody class="govuk-table__body">
        <tr class="govuk-table__row">
          <th scope="row" class="govuk-table__header">Case ID</th>
          <td class="govuk-table__cell table-width">{{ vm.caseNumber }}</td>
        </tr>
        <tr class="govuk-table__row">
          <th scope="row" class="govuk-table__header">Courthouse</th>
          <td class="govuk-table__cell table-width">{{ vm.courthouse }}</td>
        </tr>
        <tr class="govuk-table__row">
          <th scope="row" class="govuk-table__header">Judge(s)</th>
          <td class="govuk-table__cell table-width">{{ vm.judges | join }}</td>
        </tr>
        <tr class="govuk-table__row">
          <th scope="row" class="govuk-table__header">Defendant(s)</th>
          <td class="govuk-table__cell table-width">{{ vm.defendants | join }}</td>
        </tr>
      </tbody>
    </table>
  </ng-template>

  <ng-template #requestDetailsPartial>
    <tr class="govuk-table__row">
      <th scope="row" class="govuk-table__header">Hearing date</th>
      <td class="govuk-table__cell">{{ vm.hearingDate | luxonDate: 'dd MMM yyyy' }}</td>
    </tr>
    <tr class="govuk-table__row">
      <th scope="row" class="govuk-table__header">Request Type</th>
      <td class="govuk-table__cell">{{ vm.requestType }}</td>
    </tr>

    <tr class="govuk-table__row">
      <th scope="row" class="govuk-table__header">Request ID</th>
      <td class="govuk-table__cell">{{ vm.transcriptionId }}</td>
    </tr>

    <tr class="govuk-table__row">
      <th scope="row" class="govuk-table__header">Urgency</th>
      <td class="govuk-table__cell">{{ vm.urgency }}</td>
    </tr>
    @if (vm.transcriptionStartTs && vm.transcriptionEndTs) {
      <tr id="audio-times" class="govuk-table__row">
        <th scope="row" class="govuk-table__header">Audio for Transcript</th>
        <td class="govuk-table__cell">
          Start time {{ vm.transcriptionStartTs | luxonDate: 'HH:mm:ss' }} - End time
          {{ vm.transcriptionEndTs | luxonDate: 'HH:mm:ss' }}
        </td>
      </tr>
    }
  </ng-template>

  <!-- START OF VIEW TRANSCRIPT FROM CASE OR HEARING -->

  <!-- If coming from case file or hearing file page -->
  <!-- TODO: Refactor this into it's own component -->
  @if (router.url.includes('case') && router.url.includes('transcripts')) {
    <app-breadcrumb>
      <ng-container *breadcrumb="['/search']">Search</ng-container>
      <ng-container *breadcrumb="['/case', vm.caseId.toString()]">{{ vm.caseNumber }}</ng-container>
      <ng-container *breadcrumb="['.']">{{ vm.transcriptFileName }}</ng-container>
    </app-breadcrumb>

    <app-reporting-restriction
      class="margin-bottom"
      [restrictions]="vm.caseReportingRestrictions"
    ></app-reporting-restriction>

    <span class="govuk-caption-l">Transcript file</span>
    <h1 class="govuk-heading-l">{{ vm.transcriptFileName }}</h1>

    <ng-container *ngTemplateOutlet="caseDetailsTable"></ng-container>

    <table class="govuk-table">
      <caption class="govuk-table__caption govuk-table__caption--m">
        Request details
      </caption>
      <tbody class="govuk-table__body">
        <ng-container *ngTemplateOutlet="requestDetailsPartial"></ng-container>
      </tbody>
    </table>

    <button id="download-button" class="govuk-button" (click)="onDownloadClicked()">Download transcript file</button>
  }
  <!-- START OF VIEW TRANSCRIPT FROM YOUR-TRANSCRIPTS -->

  <!-- If coming from your-transcripts -->
  @if (router.url.includes('transcriptions/transcripts/')) {
    @if (vm.status?.toUpperCase() === 'REJECTED') {
      <app-rejected-transcript [transcript]="vm"> </app-rejected-transcript>
    } @else {
      <app-approved-transcript [transcript]="vm"> </app-approved-transcript>
    }
  }
} @else {
  <app-loading text="Loading transcript details..."></app-loading>
}
