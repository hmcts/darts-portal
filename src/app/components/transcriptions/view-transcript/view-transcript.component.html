<ng-container *ngIf="data$ | async as vm; else loading">
  <ng-template #caseDetailsTable>
    <table class="govuk-table">
      <caption class="govuk-table__caption govuk-table__caption--m">
        Case Details
      </caption>
      <tbody class="govuk-table__body">
        <tr class="govuk-table__row">
          <th scope="row" class="govuk-table__header">Case ID</th>
          <td class="govuk-table__cell table-width">{{ vm.transcript.case_number }}</td>
        </tr>
        <tr class="govuk-table__row">
          <th scope="row" class="govuk-table__header">Courthouse</th>
          <td class="govuk-table__cell table-width">{{ vm.transcript.courthouse }}</td>
        </tr>
        <tr class="govuk-table__row">
          <th scope="row" class="govuk-table__header">Defendant(s)</th>
          <td class="govuk-table__cell table-width">{{ vm.transcript.defendants | join }}</td>
        </tr>
        <tr class="govuk-table__row">
          <th scope="row" class="govuk-table__header">Judge(s)</th>
          <td class="govuk-table__cell table-width">{{ vm.transcript.judges | join }}</td>
        </tr>
      </tbody>
    </table>
  </ng-template>

  <ng-template #requestDetailsPartial>
    <tr class="govuk-table__row">
      <th scope="row" class="govuk-table__header">Hearing date</th>
      <td class="govuk-table__cell">{{ vm.transcript.hearing_date | date: 'dd MMM yyyy' }}</td>
    </tr>
    <tr class="govuk-table__row">
      <th scope="row" class="govuk-table__header">Request Type</th>
      <td class="govuk-table__cell">{{ vm.transcript.request_type }}</td>
    </tr>
    <tr class="govuk-table__row">
      <th scope="row" class="govuk-table__header">Urgency</th>
      <td class="govuk-table__cell">{{ vm.transcript.urgency }}</td>
    </tr>
    <tr id="audio-times" class="govuk-table__row">
      <th scope="row" class="govuk-table__header">Audio for Transcript</th>
      <td class="govuk-table__cell">
        Start time {{ vm.transcript.transcription_start_ts | date: 'HH:mm:ss' }} - End time
        {{ vm.transcript.transcription_end_ts | date: 'HH:mm:ss' }}
      </td>
    </tr>
  </ng-template>

  <!-- START OF VIEW TRANSCRIPT FROM CASE OR HEARING -->

  <!-- If coming from case file or hearing file page -->
  <ng-container *ngIf="router.url.includes('case') && router.url.includes('transcripts')">
    <app-breadcrumb>
      <ng-container *breadcrumb="['/search']">Search</ng-container>
      <ng-container *breadcrumb="['/case', vm.case.case_id.toString()]">{{ vm.transcript.case_number }}</ng-container>
      <ng-container *breadcrumb="['.']">{{ vm.transcript.transcript_file_name }}</ng-container>
    </app-breadcrumb>

    <app-reporting-restriction
      *ngIf="vm.case.reporting_restriction"
      [reportingRestriction]="vm.case.reporting_restriction"
    ></app-reporting-restriction>

    <span class="govuk-caption-l">Transcript file</span>
    <h1 class="govuk-heading-l">{{ vm.transcript.transcript_file_name }}</h1>

    <ng-container *ngTemplateOutlet="caseDetailsTable"></ng-container>

    <table class="govuk-table">
      <caption class="govuk-table__caption govuk-table__caption--m">
        Request Details
      </caption>
      <tbody class="govuk-table__body">
        <ng-container *ngTemplateOutlet="requestDetailsPartial"></ng-container>
      </tbody>
    </table>

    <button class="govuk-button" data-module="govuk-button">Download transcript file</button>
  </ng-container>

  <!-- START OF VIEW TRANSCRIPT FROM YOUR-TRANSCRIPTS -->

  <!-- If coming from your-transcripts -->
  <ng-container *ngIf="router.url.includes('transcriptions/transcripts/')">
    <app-breadcrumb>
      <ng-container *breadcrumb="['/transcriptions']">Your transcripts</ng-container>
      <ng-container *breadcrumb="['.']">{{ vm.transcript.transcript_file_name }}</ng-container>
    </app-breadcrumb>

    <app-reporting-restriction
      *ngIf="vm.case.reporting_restriction"
      [reportingRestriction]="vm.case.reporting_restriction"
    ></app-reporting-restriction>

    <span class="govuk-caption-l">Transcript file</span>
    <h1 class="govuk-heading-l">{{ vm.transcript.transcript_file_name }}</h1>

    <div>
      <strong class="govuk-tag govuk-tag--green" style="margin-bottom: 30px"> COMPLETE </strong>
      <strong class="govuk-tag govuk-tag--red" style="margin-bottom: 30px"> REJECTED </strong>
    </div>

    <ng-container *ngTemplateOutlet="caseDetailsTable"></ng-container>

    <table class="govuk-table">
      <caption class="govuk-table__caption govuk-table__caption--m">
        Request Details
      </caption>
      <tbody class="govuk-table__body">
        <ng-container *ngTemplateOutlet="requestDetailsPartial"></ng-container>
        <tr class="govuk-table__row">
          <th scope="row" class="govuk-table__header">From</th>
          <td class="govuk-table__cell">{{ vm.transcript.urgency }}</td>
        </tr>
        <tr class="govuk-table__row">
          <th scope="row" class="govuk-table__header">Received</th>
          <td class="govuk-table__cell">{{ vm.transcript.urgency }}</td>
        </tr>
        <tr class="govuk-table__row">
          <th scope="row" class="govuk-table__header">Instructions</th>
          <td class="govuk-table__cell">{{ vm.transcript.urgency }}</td>
        </tr>
        <tr class="govuk-table__row">
          <th scope="row" class="govuk-table__header">Judge Approval</th>
          <td class="govuk-table__cell">Yes</td>
        </tr>
      </tbody>
    </table>

    <button class="govuk-button" data-module="govuk-button">Download transcript file</button>
  </ng-container>
</ng-container>

<ng-template #loading>
  <app-loading text="Loading transcript details..."></app-loading>
</ng-template>
