<div *ngIf="error" class="govuk-error-summary" data-module="govuk-error-summary">
  <div role="alert">
    <h2 class="govuk-error-summary__title">There is a problem</h2>
    <div class="govuk-error-summary__body">
      <ul class="govuk-list govuk-error-summary__list">
        <li>
          <a routerLink="" fragment="user-type">{{ error }}</a>
        </li>
      </ul>
    </div>
  </div>
</div>

<!-- Start of form -->
<form [formGroup]="form" (ngSubmit)="onSubmit()">
  <div class="govuk-form-group">
    <h1 class="govuk-label-wrapper">
      <label class="govuk-label govuk-label--l" for="case-search"> Search for a case </label>
    </h1>
    <label class="govuk-label" for="case-search"> Case number </label>
    <div id="case-search-hint" class="govuk-hint">
      Also known as a case reference or court reference. There should be no spaces.
    </div>
    <input
      formControlName="case_number"
      required
      minlength="1"
      class="govuk-input govuk-input--width-10"
      id="case-search"
      name="case-search"
      type="text"
      aria-describedby="case-search-hint"
    />
  </div>
  <details class="govuk-details" data-module="govuk-details">
    <summary class="govuk-details__summary">
      <span class="govuk-details__summary-text"> Advanced search </span>
    </summary>
    <div class="govuk-form-group govuk-details__text">
      <div class="govuk-form-group">
        <!-- autocomplete -->
        <label class="govuk-label" for="advanced-case-search">Courthouse</label>
        <div #courthouseAutocomplete id="courthouse-autocomplete-container" class="govuk-input--width-20"></div>
      </div>

      <div class="govuk-form-group">
        <label class="govuk-label" for="advanced-case-search"> Courtroom </label>
        <div id="courtroom-search-hint" class="govuk-hint">For example, 3</div>
        <input
          formControlName="courtroom"
          class="govuk-input govuk-input--width-2"
          id="courtroom-search"
          name="courtroom-search"
          type="text"
          aria-describedby="courtroom-search-hint"
        />
      </div>

      <div class="govuk-form-group">
        <label class="govuk-label govuk-!-font-weight-bold" for="advanced-case-search"> Hearing date </label>
        <div id="hearingdate-search-hint" class="govuk-hint">There is limited data pre-2012.</div>
        <div class="govuk-radios" data-module="govuk-radios">
          <!-- Specific date -->
          <div class="govuk-radios__item">
            <input
              class="govuk-radios__input"
              id="specific-date-radio"
              name="specific-date-radio"
              type="radio"
              [checked]="dateInputType === 'specific'"
              (change)="toggleRadioSelected('specific')"
            />

            <label class="govuk-label govuk-radios__label" for="advanced-case-search"> Specific date </label>
          </div>

          <div
            *ngIf="dateInputType === 'specific'"
            class="govuk-form-group govuk-details__text input-group-indent-1"
            id="specific-date-items"
          >
            <div data-module="ds-datepicker" class="ds_datepicker">
              <p class="ds_hint-text">For example, 31/01/2023.</p>
              <div class="ds_input__wrapper">
                <input
                  formControlName="date_from"
                  id="specific-date"
                  type="text"
                  class="ds_input ds_input--fixed-10"
                  (change)="setInputValue($any($event).target.value, 'date_from')"
                />
              </div>
            </div>
          </div>
          <!-- End of specific date -->

          <!-- Date range -->
          <div class="govuk-radios__item">
            <input
              class="govuk-radios__input"
              id="date-range"
              name="date-range-radio"
              type="radio"
              [checked]="dateInputType === 'range'"
              (change)="toggleRadioSelected('range')"
            />
            <label class="govuk-label govuk-radios__label" for="advanced-case-search"> Date range </label>
          </div>
          <div *ngIf="dateInputType === 'range'" id="date-range-items">
            <div class="govuk-form-group govuk-details__text input-group-indent-1" id="range-date-items">
              <div data-module="ds-datepicker" class="ds_datepicker">
                <label class="ds_label" for="range-date-from">From</label>
                <p class="ds_hint-text">For example, 31/01/2023.</p>
                <p *ngIf="error" class="govuk-error-message">
                  <span class="govuk-visually-hidden">Error:</span> {{ error }}
                </p>
                <div class="ds_input__wrapper">
                  <input
                    formControlName="date_from"
                    id="range-date-from"
                    type="text"
                    class="ds_input ds_input--fixed-10"
                    (change)="setInputValue($any($event).target.value, 'date_from')"
                  />
                </div>
              </div>
            </div>

            <div class="govuk-form-group govuk-details__text input-group-indent-1">
              <div data-module="ds-datepicker" class="ds_datepicker">
                <label class="ds_label" for="range-date-to">To</label>
                <p class="ds_hint-text">For example, 31/01/2023.</p>
                <div class="ds_input__wrapper">
                  <input
                    formControlName="date_to"
                    id="range-date-to"
                    name="range-date-to"
                    type="text"
                    class="ds_input ds_input--fixed-10"
                    (change)="setInputValue($any($event).target.value, 'date_to')"
                  />
                </div>
              </div>
            </div>
          </div>
          <!-- End of date range -->
        </div>
      </div>

      <div class="govuk-form-group">
        <label class="govuk-label" for="advanced-case-search"> Defendant's name </label>
        <input
          formControlName="defendant_name"
          class="govuk-input govuk-input--width-20"
          id="defendant"
          name="defendant"
          type="text"
        />
      </div>

      <div class="govuk-form-group">
        <label class="govuk-label" for="advanced-case-search"> Judge's name </label>
        <input
          formControlName="judge_name"
          class="govuk-input govuk-input--width-20"
          id="judge"
          name="judge"
          type="text"
        />
      </div>

      <div class="govuk-form-group">
        <label class="govuk-label" for="advanced-case-search"> Keywords </label>
        <input
          formControlName="event_text_contains"
          class="govuk-input govuk-input--width-20"
          id="keywords"
          name="keywords"
          type="text"
        />
      </div>
    </div>
  </details>
  <div class="govuk-button-group">
    <button type="submit" class="govuk-button" data-module="govuk-button">Search</button>
    <a class="govuk-link" href="javascript:void(0)" (click)="clearSearch()">Clear search</a>
  </div>
</form>

<app-results [casesInput]="cases" [loaded]="loaded" [errorType]="errorType"> </app-results>
