<ng-container *ngIf="vm$ | async as vm; else loading">
  <form [formGroup]="form" class="govuk-form" (ngSubmit)="onSubmit()">
    <div class="govuk-form-group" [class.govuk-form-group--error]="isControlInvalid(courthouseNameControl)">
      <label class="govuk-label" for="courthouse-name">Courthouse name</label>
      <div id="case_number-hint" class="govuk-hint">Must be the same ID used on XHIBIT or CPP</div>
      <!-- Inline Validation Errors -->
      @for (error of getFormControlErrorMessages('courthouseName'); track error) {
        <p class="govuk-error-message courthouse-name-error">
          <span class="govuk-visually-hidden">Error:</span> {{ error }}
        </p>
      }
      <input
        class="govuk-input"
        type="text"
        id="courthouse-name"
        formControlName="courthouseName"
        [class.govuk-input--error]="isControlInvalid(courthouseNameControl)"
      />
    </div>

    <div class="govuk-form-group" [class.govuk-form-group--error]="isControlInvalid(displayNameControl)">
      <label class="govuk-label" for="display-name">Display name</label>
      <!-- Inline Validation Errors -->
      @for (error of getFormControlErrorMessages('displayName'); track error) {
        <p class="govuk-error-message display-name-error">
          <span class="govuk-visually-hidden">Error:</span> {{ error }}
        </p>
      }
      <input
        class="govuk-input"
        type="displayName"
        id="display-name"
        formControlName="displayName"
        [class.govuk-input--error]="isControlInvalid(displayNameControl)"
      />
    </div>
    <hr class="govuk-section-break govuk-section-break--xl govuk-section-break--visible" />
    <div class="govuk-form-group" [class.govuk-form-group--error]="isControlInvalid(regionControl)">
      <h2 class="govuk-heading-m">Region</h2>
      @for (error of getFormControlErrorMessages('region'); track error) {
        <p class="govuk-error-message courthouse-name-error">
          <span class="govuk-visually-hidden">Error:</span> {{ error }}
        </p>
      }
      <div class="govuk-radios" id="region-radios" data-module="govuk-radios">
        @for (region of vm.regions; track region) {
          <div class="govuk-radios__item">
            <input
              class="govuk-radios__input"
              [id]="formatNameToId(region.name) + '-radio'"
              name="approval-transcription"
              type="radio"
              [value]="region.name"
              (click)="onChangeRegion($any($event).target.value)"
            />
            <label class="govuk-label govuk-radios__label" for="approve-radio">{{ region.name }}</label>
          </div>
        }
        <label id="or-label" class="govuk-label govuk-radios__label" for="no-region">Or</label>
        <div class="govuk-radios__item">
          <input
            class="govuk-radios__input"
            id="no-region"
            name="approval-transcription"
            type="radio"
            (click)="onChangeRegion(null)"
          />
          <label class="govuk-label govuk-radios__label" for="approve-radio">No region</label>
        </div>
      </div>
    </div>
    <hr class="govuk-section-break govuk-section-break--xl govuk-section-break--visible" />
    <div class="govuk-form-group" [class.govuk-form-group--error]="isControlInvalid(regionControl)">
      <h2 class="govuk-heading-m">Transcription companies</h2>
      <span class="govuk-body">Select transcription companies</span>
      <div id="case_number-hint" class="govuk-hint">You can select and add multiple companies</div>
      <select
        class="govuk-select"
        id="transcription-type"
        name="transcription-type"
        [class.govuk-select--error]="isControlInvalid(courthouseNameControl)"
      >
        <option value="" disabled selected>Please select</option>
        @for (region of vm.regions; track region) {
          <option [value]="region.name">
            {{ region.name }}
          </option>
        }
      </select>
      <button type="submit" class="add-company-button govuk-button govuk-button--secondary">Add company</button>
    </div>

    <div class="govuk-button-group">
      <button class="govuk-button" type="submit">Continue</button>
      <a class="govuk-link" href="javascript:void(0)" (click)="onCancel()">Cancel</a>
    </div>
  </form>
</ng-container>
<ng-template #loading>
  <app-loading text="Loading..."></app-loading>
</ng-template>
