<div id="status-details" govukSummaryContainer>
  <app-govuk-heading class="no-margin" tag="h2" size="m">Current status</app-govuk-heading>
  <div class="heading-bottom govuk-!-margin-top-2"></div>
  <dl govukSummaryList>
    <div govukSummaryListRow>
      <dt govukSummaryKey>Status</dt>
      <dd govukSummaryValue>
        {{ transcript.status }}
      </dd>
      <dd govukSummaryListAction>
        <a
          class="govuk-link"
          [routerLink]="`/admin/transcripts/${transcript.transcriptionId}/change-status`"
          [queryParams]="{ manual: transcript.isManual, status: transcript.status }"
          >Change status
          <span class="govuk-visually-hidden">Change transcription status</span>
        </a>
      </dd>
    </div>

    <div govukSummaryListRow>
      <dt govukSummaryKey>Last actioned by</dt>
      <dd govukSummaryValue>
        @if (transcript.assignedTo?.userId) {
          <a
            class="govuk-link"
            [routerLink]="['/admin/users', transcript.assignedTo?.userId]"
            [queryParams]="{ backUrl: '/admin/transcripts/' + transcript.transcriptionId }"
            >{{ transcript.assignedTo?.fullName }}</a
          >
          <span class="govuk-caption-m"> ({{ transcript.assignedTo?.email }})</span>
        } @else {
          Unassigned
        }
      </dd>
    </div>
<<<<<<< HEAD

    <div govukSummaryListRow>
      <dt govukSummaryKey>Associated groups</dt>
      <dd govukSummaryValue>
        @if (
          transcript.status !== 'Awaiting Authorisation' &&
          transcript.status !== 'Requested' &&
          transcript.assignedGroups?.length
        ) {
          @for (group of transcript.assignedGroups; track group.id) {
            @if (group.displayName || group.name) {
              @if (isAdmin) {
                <div>
                  <a
                    class="govuk-link"
                    [routerLink]="['/admin/groups', group.id]"
                    [queryParams]="{ backUrl: '/admin/transcripts/' + transcript.transcriptionId }"
                  >
                    {{ group.displayName || group.name }}
                  </a>
                </div>
              } @else {
                <span>{{ group.displayName || group.name }}</span>
              }
            }
          }
        } @else {
          -
        }
      </dd>
    </div>
  </dl>
</div>

=======
  </dl>
</div>

>>>>>>> cc557f68 (Resolve backurl conflict)
<div id="request-details" govukSummaryContainer>
  <app-govuk-heading class="no-margin" tag="h2" size="m">Request details</app-govuk-heading>
  <div class="heading-bottom govuk-!-margin-top-2"></div>
  <dl govukSummaryList>
    <div govukSummaryListRow>
      <dt govukSummaryKey>Hearing date</dt>
      <dd govukSummaryValue>
        <a
          class="govuk-link"
          [routerLink]="`/admin/case/${transcript.caseId}/hearing/${transcript.hearingId}`"
          [queryParams]="{ backUrl: '/admin/transcripts/' + transcript.transcriptionId }"
        >
          {{ transcript.hearingDate | luxonDate: 'dd MMM yyyy' }}
        </a>
      </dd>
    </div>

    <div govukSummaryListRow>
      <dt govukSummaryKey>Request type</dt>
      <dd govukSummaryValue>
        {{ transcript.requestType }}
      </dd>
    </div>

    <div govukSummaryListRow>
      <dt govukSummaryKey>Request method</dt>
      <dd govukSummaryValue>
        {{ transcript.isManual ? 'Manual' : 'Automated' }}
      </dd>
    </div>

    <div govukSummaryListRow>
      <dt govukSummaryKey>Request ID</dt>
      <dd govukSummaryValue>
        {{ transcript.transcriptionId }}
      </dd>
    </div>

    <div govukSummaryListRow>
      <dt govukSummaryKey>Urgency</dt>
      <dd govukSummaryValue>
        {{ transcript.urgency.description ? transcript.urgency.description : '' }}
      </dd>
    </div>

    <div govukSummaryListRow>
      <dt govukSummaryKey>Audio for transcript</dt>
      <dd govukSummaryValue>
        {{
          transcript.transcriptionStartTs && transcript.transcriptionEndTs
            ? 'Start time ' +
              (transcript.transcriptionStartTs | luxonDate: 'HH:mm:ss') +
              ' - End time ' +
              (transcript.transcriptionEndTs | luxonDate: 'HH:mm:ss')
            : ''
        }}
      </dd>
    </div>

    <div govukSummaryListRow>
      <dt govukSummaryKey>Requested by</dt>
      <dd govukSummaryValue>
        <a
          class="govuk-link"
          [routerLink]="['/admin/users', transcript.requestor?.userId]"
          [queryParams]="{ backUrl: '/admin/transcripts/' + transcript.transcriptionId }"
          >{{ transcript.requestor?.fullName }}</a
        >
        <span class="govuk-caption-m"> ({{ transcript.requestor?.email }})</span>
      </dd>
    </div>

    <div govukSummaryListRow>
      <dt govukSummaryKey>Received</dt>
      <dd govukSummaryValue>
        {{ transcript.received | luxonDate: 'dd MMM yyyy HH:mm:ss' }}
      </dd>
    </div>

    @if (transcript.approved) {
      <div govukSummaryListRow>
        <dt govukSummaryKey>Approved on</dt>
        <dd govukSummaryValue>
          {{ transcript.approved | luxonDate: 'dd MMM yyyy HH:mm:ss' }}
        </dd>
      </div>
    }

    <div govukSummaryListRow>
      <dt govukSummaryKey>Instructions</dt>
      <dd govukSummaryValue>
        {{ transcript.requestorComments }}
      </dd>
    </div>

    <div govukSummaryListRow>
      <dt govukSummaryKey>Judge approval</dt>
      <dd govukSummaryValue>Yes</dd>
    </div>

    @if (transcript.legacyComments) {
      <div govukSummaryListRow>
        <dt govukSummaryKey>Migrated legacy data comments</dt>
        <dd govukSummaryValue>{{ transcript.legacyComments }}</dd>
      </div>
    }
  </dl>
</div>

<div id="case-details" govukSummaryContainer>
  <app-govuk-heading class="no-margin" tag="h2" size="m">Case details</app-govuk-heading>
  <div class="heading-bottom govuk-!-margin-top-2"></div>
  <dl govukSummaryList>
    <div govukSummaryListRow>
      <dt govukSummaryKey>Case ID</dt>
      <dd govukSummaryValue>
        <a
          class="govuk-link"
          [routerLink]="['/admin/case', transcript.caseId]"
          [queryParams]="{ backUrl: '/admin/transcripts/' + transcript.transcriptionId }"
          >{{ transcript.caseNumber }}</a
        >
      </dd>
    </div>

    <div govukSummaryListRow>
      <dt govukSummaryKey>Courthouse</dt>
      <dd govukSummaryValue>{{ transcript.courthouse }}</dd>
    </div>

    <div govukSummaryListRow>
      <dt govukSummaryKey>Judge(s)</dt>
      <dd govukSummaryValue [preserveLineBreaks]="true">
        {{ transcript.judges | join: undefined : undefined : true }}
      </dd>
    </div>

    <div govukSummaryListRow>
      <dt govukSummaryKey>Defendant(s)</dt>
      <dd govukSummaryValue [preserveLineBreaks]="true">
        {{ transcript.defendants | join: undefined : undefined : true }}
      </dd>
    </div>
  </dl>
</div>
